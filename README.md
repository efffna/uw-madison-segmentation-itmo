# Training & Inference

Здесь представлены ноутбуки для обучения и инференса моделей в соревновании [UW-Madison GI Tract Image Segmentation](https://www.kaggle.com/competitions/uw-madison-gi-tract-image-segmentation/).

## Description

Цель соревнования: сегментировать на изображении (слайс DICOM) целевые метки - желудок, тонкая и толстая кишка.

Весь пайплайн разделен на 2 части, так как в качестве submission файла на платформу загружается ноутбук с созданием submission.csv, по которому происходит расчет итогового скора. При этом при инференсе необязательно иметь цикл обучения модели, но при этом нужно иметь возможность импортировать библиотеки и загружать веса модели без интернета. 

Для инференса и отправки решения необходимо загрузить ноутбук на платформу Kaggle и добавить в него следующие данные:
* uw-madison-gi-tract-image-segmentation
* pytorch-segmentation-models-lib
* uwmgi-mask-dataset
* uwgaifullin (здесь находятся веса обученной модели)

Добавление происходит путем нажатия на кнопку `Add data` в правом верхнем углу.

## Submit

Ноутбук `submit.ipynb` должен создавать файл `submission.csv`, без этого не получится загрузить решение на платформу, поэтому перед сабмитом ноутбука его требуется запустить и получить данный файл. Так как данные с теста не видны участнику, то нужно, чтобы в процессе дебага была возможность использования других данных и получения на них submission.csv. В случае сабмита ноутбук должен сам автоматически подгрузить тестовые данные, прогнать по ним модель и сохранить прогнозы в submission.csv, по которому и произойдет подсчет скора.
